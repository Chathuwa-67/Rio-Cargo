<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Liquidación - Rio Cargo Express</title>
    <!-- Bootstrap 4 -->
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
    />
    <!-- FontAwesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"
    />
    <!-- Bootstrap Datepicker -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/css/bootstrap-datepicker.min.css"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="https://courier.riocargoexpress.com/assets/images/logo-rio2.png"
    />
    <style>
      body {
        background: #00205d;
        font-family: Arial, sans-serif;
      }

      /* Navbar Styles */
      .navbar-container {
        display: flex;
        align-items: center;
        padding: 10px 0 10px 15px;
        position: relative;
        flex-wrap: wrap;
      }

      .navbar-custom {
        display: flex;
        justify-content: space-between;
        align-items: center;
        background: #0034c5;
        border-radius: 25px 0 0 25px;
        padding: 10px 20px;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4);
        flex: 1;
        margin-left: 10px;
      }

      .logo img {
        height: 100px;
        margin-right: 15px;
      }

      .navbar-nav-custom {
        display: flex;
        list-style: none;
        margin: 0;
        padding: 0;
        flex-wrap: wrap;
      }

      .navbar-nav-custom li {
        margin: 0 18px;
        position: relative;
      }

      .navbar-nav-custom li a {
        text-decoration: none;
        color: #fff;
        font-weight: 500;
        transition: color 0.3s;
        font-size: 15px;
      }

      .navbar-nav-custom li a:hover {
        color: #ffd700;
      }

      .nav-icons {
        display: flex;
        align-items: center;
        gap: 20px;
      }

      .nav-icons a {
        color: white;
        font-size: 18px;
        margin-left: 15px;
        text-decoration: none;
      }

      .nav-icons a:hover {
        color: #ffd700;
      }

      .navbar-nav-custom li ul.dropdown-menu-custom {
        display: none;
        position: absolute;
        top: 100%;
        left: 0;
        background: #0034c5;
        border-radius: 10px;
        padding: 8px 0;
        list-style: none;
        min-width: 200px;
        z-index: 1000;
      }

      .navbar-nav-custom li ul.dropdown-menu-custom li {
        margin: 0;
      }

      .navbar-nav-custom li ul.dropdown-menu-custom li a {
        display: block;
        padding: 8px 15px;
        color: #fff;
        font-size: 14px;
        white-space: nowrap;
      }

      .navbar-nav-custom li ul.dropdown-menu-custom li a:hover {
        background: #002a99;
        color: #ffd700;
      }

      /* Show dropdown on hover */
      .navbar-nav-custom li:hover > ul.dropdown-menu-custom {
        display: block;
      }

      .profile-icon {
        background: #007bff;
        border-radius: 50%;
        padding: 6px;
      }

      .nav-icons img {
        width: 30px;
      }

      /* Form Card */
      .card-custom {
        background-color: #0034c5;
        border-radius: 25px;
        padding: 25px;
        color: white;
        box-shadow: 0 6px 18px rgba(0, 0, 0, 0.4);
        margin-bottom: 20px;
        font-weight: 600;
      }

      /* Dropdown cards */
      .dropdown-card {
        position: absolute;
        top: 70px;
        right: 20px;
        background: #ffffff;
        color: #000;
        width: 280px;
        border-radius: 12px;
        box-shadow: 0 6px 18px rgba(0, 0, 0, 0.3);
        padding: 15px;
        display: none;
        z-index: 10;
        animation: fadeInUp 0.3s ease;
      }

      .dropdown-card h6 {
        font-weight: bold;
        margin-bottom: 5px;
      }

      .dropdown-card hr {
        margin: 8px 0;
      }

      .dropdown-card a {
        display: block;
        color: #0034c5;
        font-weight: 500;
        padding: 5px 0;
        text-decoration: none;
      }

      .dropdown-card a:hover {
        color: #ff9900;
      }

      /* Animation */
      @keyframes fadeInUp {
        from {
          opacity: 0;
          transform: translateY(15px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      /* Custom alert style */
      .custom-alert {
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 9999;
        min-width: 300px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        border: none;
        border-left: 4px solid #28a745;
        opacity: 0;
        transform: translateX(100%);
        transition: opacity 0.5s, transform 0.5s;
      }

      .custom-alert.show {
        opacity: 1;
        transform: translateX(0);
      }

      .alert-success {
        background-color: #d4edda;
        color: #155724;
      }

      /* Liquidación specific styles */
      .filter-section {
        background: #0034c5;
        border-radius: 15px;
        padding: 20px;
        margin-bottom: 20px;
      }

      .filter-row {
        display: flex;
        flex-wrap: wrap;
        gap: 15px;
        margin-bottom: 15px;
      }

      .filter-item {
        flex: 1;
        min-width: 200px;
      }

      .filter-item label {
        color: white;
        font-weight: 600;
        margin-bottom: 5px;
        display: block;
      }

      .table-container {
        background: white;
        border-radius: 15px;
        padding: 20px;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      }

      .table-custom {
        width: 100%;
        border-collapse: collapse;
        table-layout: fixed;
      }

      .table-custom th {
        background: #0034c5;
        color: white;
        padding: 15px 8px;
        text-align: left;
        font-weight: 600;
        cursor: pointer;
        user-select: none;
        position: relative;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: normal;
        line-height: 1.3;
        height: 60px;
        vertical-align: middle;
      }

      .table-custom th:hover {
        background: #002a99;
      }

      .table-custom td {
        padding: 12px 8px;
        border-bottom: 1px solid #e0e0e0;
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: normal;
        vertical-align: middle;
        line-height: 1.4;
        height: 70px;
      }

      .table-custom tr:hover {
        background-color: #f5f5f5;
      }

      /* Column width adjustments */
      .table-custom th:nth-child(1),
      .table-custom td:nth-child(1) {
        width: 8%;
      } /* F/Registro */
      .table-custom th:nth-child(2),
      .table-custom td:nth-child(2) {
        width: 10%;
      } /* # Tracking */
      .table-custom th:nth-child(3),
      .table-custom td:nth-child(3) {
        width: 9%;
      } /* Asociado */
      .table-custom th:nth-child(4),
      .table-custom td:nth-child(4) {
        width: 8%;
      } /* Agrupación */
      .table-custom th:nth-child(5),
      .table-custom td:nth-child(5) {
        width: 8%;
      } /* Total Agrupados */
      .table-custom th:nth-child(6),
      .table-custom td:nth-child(6) {
        width: 8%;
      } /* Cupón de descuento */
      .table-custom th:nth-child(7),
      .table-custom td:nth-child(7) {
        width: 12%;
      } /* Estado - Increased width */
      .table-custom th:nth-child(8),
      .table-custom td:nth-child(8) {
        width: 6%;
      } /* Peso en kilos */
      .table-custom th:nth-child(9),
      .table-custom td:nth-child(9) {
        width: 6%;
      } /* Peso en libras */
      .table-custom th:nth-child(10),
      .table-custom td:nth-child(10) {
        width: 5%;
      } /* UF */
      .table-custom th:nth-child(11),
      .table-custom td:nth-child(11) {
        width: 10%;
      } /* Descripción */
      .table-custom th:nth-child(12),
      .table-custom td:nth-child(12) {
        width: 10%;
      } /* Observaciones */
      .table-custom th:nth-child(13),
      .table-custom td:nth-child(13) {
        width: 6%;
      } /* Grupo */
      .table-custom th:nth-child(14),
      .table-custom td:nth-child(14) {
        width: 6%;
      } /* Acciones */

      .pagination-info {
        color: #666;
        margin-bottom: 10px;
      }

      .pagination-custom .page-link {
        color: #0034c5;
        border: 1px solid #0034c5;
      }

      .pagination-custom .page-item.active .page-link {
        background: #0034c5;
        border-color: #0034c5;
      }

      .entries-select {
        width: 80px;
        display: inline-block;
        margin: 0 10px;
      }

      /* Form controls styling */
      .form-control-custom {
        background: #002a99;
        border: 1px solid #0048ff;
        border-radius: 8px;
        color: white;
        padding: 8px 12px;
      }

      .form-control-custom::placeholder {
        color: #a0c0ff;
      }

      .form-control-custom:focus {
        background: #002a99;
        border-color: #ffd700;
        color: white;
        box-shadow: 0 0 0 0.2rem rgba(255, 215, 0, 0.25);
      }

      /* Sorting arrows */
      .sort-arrows {
        display: inline-block;
        margin-left: 5px;
        vertical-align: middle;
      }

      .sort-arrow {
        display: block;
        font-size: 10px;
        line-height: 8px;
        color: #ccc;
      }

      .sort-arrow.active {
        color: #ffd700;
      }

      .sort-arrow.up {
        margin-bottom: 1px;
      }

      /* Filter controls row */
      .filter-controls-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 15px;
        flex-wrap: wrap;
        gap: 15px;
      }

      .search-box {
        flex: 1;
        min-width: 250px;
        max-width: 400px;
      }

      .filter-buttons {
        display: flex;
        gap: 10px;
      }

      /* Currency styling */
      .currency {
        text-align: right;
        font-family: "Courier New", monospace;
        font-weight: 600;
      }

      /* Action buttons styling */
      .action-buttons {
        display: flex;
        flex-direction: column;
        gap: 5px;
        justify-content: center;
      }

      .action-btn {
        background: none;
        border: none;
        color: #0034c5;
        cursor: pointer;
        font-size: 14px;
        transition: color 0.3s;
        padding: 2px 5px;
        text-align: left;
        display: flex;
        align-items: center;
        width: 100%;
      }

      .action-btn:hover {
        color: #ff9900;
        background-color: #f8f9fa;
      }

      .action-btn i {
        margin-right: 5px;
        width: 16px;
        text-align: center;
      }

      .info-btn {
        background-color: #0034c5;
        color: white;
        border: none;
        border-radius: 4px;
        padding: 6px 10px;
        font-size: 11px;
        cursor: pointer;
        transition: background-color 0.3s;
        display: block;
        margin-top: 5px;
        width: 100%;
        white-space: nowrap;
      }

      .info-btn:hover {
        background-color: #002a99;
      }

      .gift-icon {
        color: #ff9900;
        margin-right: 5px;
      }

      /* Estado column specific styling */
      .estado-content {
        display: flex;
        flex-direction: column;
        align-items: flex-start;
        justify-content: center;
        height: 100%;
      }

      .estado-text {
        margin-bottom: 5px;
        line-height: 1.2;
      }

      /* Gear icon in header */
      .gear-header {
        text-align: center;
      }

      .gear-header i {
        font-size: 18px;
      }

      /* Modal Styles */
      .modal-header-custom {
        background: #0034c5;
        color: white;
        border-bottom: none;
        border-radius: 10px 10px 0 0;
      }

      .modal-content-custom {
        border-radius: 10px;
        border: none;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      }

      .modal-footer-custom {
        border-top: 1px solid #e9ecef;
        padding: 15px;
      }

      /* Status Modal Styles */
      .status-modal-icon {
        font-size: 60px;
        color: #ff9900;
        text-align: center;
        margin-bottom: 20px;
      }

      .status-modal-content {
        text-align: center;
        padding: 10px 20px;
      }

      /* File Upload Styles */
      .file-upload-container {
        border: 2px dashed #0034c5;
        border-radius: 10px;
        padding: 30px;
        text-align: center;
        background-color: #f8f9fa;
        transition: all 0.3s;
        cursor: pointer;
      }

      .file-upload-container:hover {
        background-color: #e9ecef;
        border-color: #002a99;
      }

      .file-upload-container.dragover {
        background-color: #e3f2fd;
        border-color: #0034c5;
      }

      .file-upload-icon {
        font-size: 48px;
        color: #0034c5;
        margin-bottom: 15px;
      }

      .file-upload-text {
        color: #0034c5;
        font-weight: 500;
      }

      .file-upload-hint {
        color: #6c757d;
        font-size: 14px;
        margin-top: 10px;
      }

      /* Custom buttons */
      .hello-btn {
        background-color: #28a745;
        color: white;
        border: none;
        border-radius: 8px;
        padding: 8px 15px;
        font-weight: 600;
        transition: background-color 0.3s;
      }

      .hello-btn:hover {
        background-color: #218838;
      }
      .filter-row:first-child {
        margin-bottom: 15px;
      }

      .hello2-btn {
        background-color: #28a745;
        color: white;
        border: none;
        border-radius: 8px;
        padding: 8px 15px;
        font-weight: 600;
        transition: background-color 0.3s;
      }

      .hello2-btn:hover {
        background-color: #218838;
      }
      .action-row {
        display: flex;
        justify-content: space-between;
        gap: 3px;
        margin-bottom: 3px;
      }

      .action-row:last-child {
        margin-bottom: 0;
      }

      .action-btn {
        background: none;
        border: none;
        color: #0034c5;
        cursor: pointer;
        font-size: 12px;
        transition: color 0.3s;
        padding: 3px 4px;
        flex: 1;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 3px;
        min-width: 0;
      }

      .action-btn:hover {
        color: #ff9900;
        background-color: #f8f9fa;
      }

      .action-btn i {
        font-size: 12px;
        min-width: 12px;
      }

      /* Responsive adjustments */
      @media (max-width: 1200px) {
        .table-custom th,
        .table-custom td {
          padding: 12px 6px;
          font-size: 13px;
        }

        .table-custom th {
          height: 70px;
        }

        .table-custom td {
          height: 75px;
        }

        .table-custom th:nth-child(1),
        .table-custom td:nth-child(1) {
          width: 9%;
        }
        .table-custom th:nth-child(2),
        .table-custom td:nth-child(2) {
          width: 11%;
        }
        .table-custom th:nth-child(3),
        .table-custom td:nth-child(3) {
          width: 10%;
        }
        .table-custom th:nth-child(4),
        .table-custom td:nth-child(4) {
          width: 9%;
        }
        .table-custom th:nth-child(5),
        .table-custom td:nth-child(5) {
          width: 9%;
        }
        .table-custom th:nth-child(6),
        .table-custom td:nth-child(6) {
          width: 9%;
        }
        .table-custom th:nth-child(7),
        .table-custom td:nth-child(7) {
          width: 13%;
        } /* Estado - Increased width */
        .table-custom th:nth-child(8),
        .table-custom td:nth-child(8) {
          width: 7%;
        }
        .table-custom th:nth-child(9),
        .table-custom td:nth-child(9) {
          width: 7%;
        }
        .table-custom th:nth-child(10),
        .table-custom td:nth-child(10) {
          width: 6%;
        }
        .table-custom th:nth-child(11),
        .table-custom td:nth-child(11) {
          width: 11%;
        }
        .table-custom th:nth-child(12),
        .table-custom td:nth-child(12) {
          width: 11%;
        }
        .table-custom th:nth-child(13),
        .table-custom td:nth-child(13) {
          width: 7%;
        }
        .table-custom th:nth-child(14),
        .table-custom td:nth-child(14) {
          width: 7%;
        }
      }

      @media (max-width: 992px) {
        .navbar-custom {
          flex-wrap: wrap;
          border-radius: 20px;
          padding: 10px;
        }
        .navbar-nav-custom {
          flex-direction: column;
          align-items: flex-start;
          width: 100%;
          margin-top: 10px;
        }
        .nav-icons {
          margin-top: 10px;
          width: 100%;
          justify-content: flex-start;
        }
        .filter-item {
          min-width: 150px;
        }
        .filter-controls-row {
          flex-direction: column;
          align-items: stretch;
        }
        .search-box {
          max-width: 100%;
        }
        .filter-buttons {
          justify-content: flex-end;
        }

        .table-container {
          overflow-x: auto;
        }

        .table-custom {
          min-width: 1200px;
        }
      }

      @media (max-width: 768px) {
        .logo img {
          height: 50px;
        }
        .navbar-nav-custom li {
          margin: 6px 0;
        }
        .nav-icons a {
          font-size: 16px;
          margin-left: 10px;
        }
        .custom-alert {
          left: 20px;
          right: 20px;
          min-width: auto;
        }
        .modal-dialog {
          margin: 10px;
        }
      }

      @media (max-width: 576px) {
        .navbar-container {
          flex-direction: column;
          padding: 10px;
        }
        .navbar-custom {
          margin-left: 0;
          border-radius: 20px;
        }
        .filter-item {
          min-width: 100%;
        }
        .filter-buttons {
          flex-direction: column;
        }
      }
    </style>
  </head>
  <body>
    <!-- Custom Alert Container -->
    <div
      id="alertContainer"
      class="custom-alert alert alert-success"
      role="alert"
      style="display: none"
    >
      <div class="d-flex align-items-center">
        <i class="fas fa-check-circle mr-2"></i>
        <span id="alertMessage"></span>
      </div>
    </div>

    <!-- Navbar -->
    <header class="navbar-container">
      <div class="logo">
        <img src="./src/img/logo.png" alt="Rio Cargo Express Logo" />
      </div>
      <nav class="navbar-custom">
        <ul class="navbar-nav-custom">
          <!-- Tablero with dropdown -->
          <li class="dropdown">
            <a href="#">Tablero <i class="fas fa-caret-down"></i></a>
            <ul class="dropdown-menu-custom">
              <li><a href="./index.html">Registrar paquete</a></li>
              <li>
                <a href="./Estado de Paquetes.html">Estado de paquetes</a>
              </li>
              <li><a href="./Asociados.html">Asociados</a></li>
              <li><a href="./Cupos.html">Cupos</a></li>
            </ul>
          </li>

          <!-- Liquidación with dropdown -->
          <li class="dropdown">
            <a href="#">Liquidación <i class="fas fa-caret-down"></i></a>
            <ul class="dropdown-menu-custom">
              <li><a href="./casilleros.html">Casilleros</a></li>
              <li><a href="./tutoriales.html">Tutoriales</a></li>
              <li><a href="#">Tiendas</a></li>
              <li><a href="./cotizar.html">Cotizador</a></li>
            </ul>
          </li>

          <!-- Programas de Recompensa (normal) -->
          <li class="dropdown">
            <a href="#">Guías y Casilleros <i class="fas fa-caret-down"></i></a>
            <ul class="dropdown-menu-custom">
              <li>
                <a href="./Liquidaciones_Pendientes.html"
                  >Liquidaciones Pendientes</a
                >
              </li>
              <li>
                <a href="./Liquidaciones_Canceladas.html"
                  >Liquidaciones Canceladas</a
                >
              </li>
              <li><a href="./Cuentas_Bancarias.html">Cuentas Bancarias</a></li>
            </ul>
          </li>

          <!-- Historial de Tracking (normal) -->
          <li><a href="#">Wishlist</a></li>
        </ul>

        <!-- Nav icons -->
        <div class="nav-icons">
          <a href="javascript:void(0)" id="alertBtn"
            ><i class="fas fa-exclamation"></i
          ></a>
          <a href="javascript:void(0)" id="bellBtn"
            ><i class="fas fa-bell"></i
          ></a>
          <a href="javascript:void(0)" id="mailBtn"
            ><i class="fas fa-envelope"></i
          ></a>
          <a href="javascript:void(0)" id="userBtn" class="profile-icon">
            <img
              src="https://courier.riocargoexpress.com/assets/images/users/user.png"
              alt="profileLogo"
              style="cursor: pointer"
            />
          </a>
        </div>
      </nav>
    </header>

    <!-- Dropdown cards -->
    <div class="dropdown-card" id="alertCard">
      <h6>Alertas</h6>
      <hr />
      <p>Mensaje de alerta de ejemplo.</p>
    </div>

    <div class="dropdown-card" id="bellCard">
      <h6>Notificaciones</h6>
      <hr />
      <p>Tu paquete está en camino 🚚</p>
      <p>Nuevo mensaje recibido 📩</p>
    </div>

    <div class="dropdown-card" id="mailCard">
      <h6>Tienes 0 paquetes en retención</h6>
      <hr />
      <p>No hay paquetes retenidos.</p>
    </div>

    <div class="dropdown-card" id="userCard">
      <h6>Casillero</h6>
      <p><strong>216258</strong></p>
      <p>María Teresa Silva Pinoargote</p>
      <p>tetesilva0908@gmail.com</p>
      <hr />
      <div
        style="
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-top: 5px;
        "
      >
        <a href="./Perfil.html"><i class="fas fa-user"></i> Mi Perfil</a>
        <a href="#"><i class="fas fa-sign-out-alt"></i> Logout</a>
      </div>
    </div>

    <!-- Heading -->
    <h2 class="text-center text-white mt-5 font-weight-bold pb-3">
      Estado de Paquetes
    </h2>

    <div class="container-fluid mt-3">
      <!-- Filter Section -->
      <div class="filter-section">
        <!-- Hello Button Row -->
        <div
          class="filter-row"
          style="justify-content: flex-end; margin-bottom: 15px"
        >
          <div class="filter-item" style="flex: 0 0 auto">
            <button
              class="btn hello-btn"
              id="helloBtn"
              style="margin-top: 24px"
            >
              Agregar nueva Agrupación
            </button>
          </div>
        </div>

        <!-- Date Filters -->
        <div class="filter-row">
          <div class="filter-item">
            <label for="desde">Desde</label>
            <input
              type="text"
              class="form-control form-control-custom datepicker"
              id="desde"
              placeholder="Seleccionar fecha"
            />
          </div>
          <div class="filter-item">
            <label for="hasta">Hasta</label>
            <input
              type="text"
              class="form-control form-control-custom datepicker"
              id="hasta"
              placeholder="Seleccionar fecha"
            />
          </div>
          <div class="filter-item">
            <label for="tracking">Tracking</label>
            <input
              type="text"
              class="form-control form-control-custom"
              id="tracking"
              placeholder="Número de tracking"
            />
          </div>
          <div class="filter-item">
            <label for="descripcion">Asociado</label>
            <div class="d-flex align-items-end">
              <input
                type="text"
                class="form-control form-control-custom mr-2"
                id="descripcion"
              />
            </div>
          </div>
        </div>

        <!-- Filter Controls Row -->
        <div class="filter-controls-row">
          <div class="filter-buttons">
            <button class="btn btn-warning" id="filtrarBtn">
              <i class="fas fa-filter"></i> Filtrar
            </button>
            <button class="btn btn-outline-light" id="limpiarBtn">
              <i class="fas fa-broom"></i> Limpiar
            </button>
            <button class="btn hello2-btn" id="hello2Btn">
              <i class="fas fa-file-excel"></i>
            </button>
          </div>
        </div>
      </div>

      <!-- Table Section -->
      <div class="table-container mb-5">
        <div class="d-flex justify-content-between align-items-center mb-3">
          <div>
            <label for="entriesSelect" class="mr-2">Show</label>
            <select class="form-control entries-select" id="entriesSelect">
              <option value="20">20</option>
              <option value="50">50</option>
              <option value="100">100</option>
              <option value="all">All</option>
            </select>
            <span>entries</span>
          </div>
        </div>

        <div class="table-responsive">
          <table class="table-custom">
            <thead>
              <tr>
                <th data-sort="fRegistro">
                  F/Registro
                  <span class="sort-arrows">
                    <i class="fas fa-caret-up sort-arrow up"></i>
                    <i class="fas fa-caret-down sort-arrow down"></i>
                  </span>
                </th>
                <th data-sort="tracking">
                  # Tracking
                  <span class="sort-arrows">
                    <i class="fas fa-caret-up sort-arrow up"></i>
                    <i class="fas fa-caret-down sort-arrow down"></i>
                  </span>
                </th>
                <th data-sort="asociado">
                  Asociado
                  <span class="sort-arrows">
                    <i class="fas fa-caret-up sort-arrow up"></i>
                    <i class="fas fa-caret-down sort-arrow down"></i>
                  </span>
                </th>
                <th data-sort="agrupacion">
                  Agrupación
                  <span class="sort-arrows">
                    <i class="fas fa-caret-up sort-arrow up"></i>
                    <i class="fas fa-caret-down sort-arrow down"></i>
                  </span>
                </th>
                <th data-sort="totalAgrupados" class="currency">
                  Total Agrupados
                  <span class="sort-arrows">
                    <i class="fas fa-caret-up sort-arrow up"></i>
                    <i class="fas fa-caret-down sort-arrow down"></i>
                  </span>
                </th>
                <th data-sort="cuponDescuento">
                  Cupón de descuento
                  <span class="sort-arrows">
                    <i class="fas fa-caret-up sort-arrow up"></i>
                    <i class="fas fa-caret-down sort-arrow down"></i>
                  </span>
                </th>
                <th data-sort="estado">
                  Estado
                  <span class="sort-arrows">
                    <i class="fas fa-caret-up sort-arrow up"></i>
                    <i class="fas fa-caret-down sort-arrow down"></i>
                  </span>
                </th>
                <th data-sort="pesoKilos" class="currency">
                  Peso en kilos
                  <span class="sort-arrows">
                    <i class="fas fa-caret-up sort-arrow up"></i>
                    <i class="fas fa-caret-down sort-arrow down"></i>
                  </span>
                </th>
                <th data-sort="pesoLibras" class="currency">
                  Peso en libras
                  <span class="sort-arrows">
                    <i class="fas fa-caret-up sort-arrow up"></i>
                    <i class="fas fa-caret-down sort-arrow down"></i>
                  </span>
                </th>
                <th data-sort="uf" class="currency">
                  UF
                  <span class="sort-arrows">
                    <i class="fas fa-caret-up sort-arrow up"></i>
                    <i class="fas fa-caret-down sort-arrow down"></i>
                  </span>
                </th>
                <th data-sort="descripcion">
                  Descripción
                  <span class="sort-arrows">
                    <i class="fas fa-caret-up sort-arrow up"></i>
                    <i class="fas fa-caret-down sort-arrow down"></i>
                  </span>
                </th>
                <th data-sort="observaciones">
                  Observaciones
                  <span class="sort-arrows">
                    <i class="fas fa-caret-up sort-arrow up"></i>
                    <i class="fas fa-caret-down sort-arrow down"></i>
                  </span>
                </th>
                <th data-sort="grupo">
                  Grupo
                  <span class="sort-arrows">
                    <i class="fas fa-caret-up sort-arrow up"></i>
                    <i class="fas fa-caret-down sort-arrow down"></i>
                  </span>
                </th>
                <th class="gear-header">
                  <i class="fas fa-cog"></i>
                </th>
              </tr>
            </thead>
            <tbody id="tableBody">
              <!-- Data will be populated by JavaScript -->
            </tbody>
          </table>
        </div>

        <div class="d-flex justify-content-between align-items-center mt-3">
          <div class="pagination-info" id="paginationInfo">
            Showing 0 to 0 of 0 entries
          </div>
          <nav>
            <ul class="pagination pagination-custom" id="pagination">
              <!-- Pagination will be generated by JavaScript -->
            </ul>
          </nav>
        </div>
      </div>
    </div>

    <!-- Edit Modal -->
    <div
      class="modal fade"
      id="editModal"
      tabindex="-1"
      role="dialog"
      aria-labelledby="editModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-lg" role="document">
        <div class="modal-content modal-content-custom">
          <div class="modal-header modal-header-custom">
            <h5 class="modal-title" id="editModalLabel">Editar</h5>
            <button
              type="button"
              class="close"
              data-dismiss="modal"
              aria-label="Close"
            >
              <span aria-hidden="true" style="color: white">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <form id="editForm">
              <div class="form-group">
                <label for="ordenEnvio">Orden de envío</label>
                <input
                  type="text"
                  class="form-control"
                  id="ordenEnvio"
                  placeholder="Ingrese la orden de envío"
                />
              </div>
              <div class="form-group">
                <label for="noTracking">No de Tracking</label>
                <input
                  type="text"
                  class="form-control"
                  id="noTracking"
                  placeholder="Ingrese el número de tracking"
                />
              </div>
              <div class="form-group">
                <label for="valorCompra">Valor de la Compra</label>
                <input
                  type="text"
                  class="form-control"
                  id="valorCompra"
                  placeholder="Ingrese el valor de la compra"
                />
              </div>
              <div class="form-group">
                <label>Por favor suba su factura de compra</label>
                <div class="file-upload-container" id="fileUploadContainer">
                  <div class="file-upload-icon">
                    <i class="fas fa-cloud-upload-alt"></i>
                  </div>
                  <div class="file-upload-text">
                    Suelte los archivos aquí o haga clic para cargar
                  </div>
                  <div class="file-upload-hint">
                    Al agregar un nuevo archivo los anteriores serán eliminados
                  </div>
                  <input
                    type="file"
                    id="fileInput"
                    style="display: none"
                    accept="image/*"
                  />
                </div>
              </div>
            </form>
          </div>
          <div class="modal-footer modal-footer-custom">
            <button
              type="button"
              class="btn btn-secondary"
              data-dismiss="modal"
            >
              Cancelar
            </button>
            <button type="button" class="btn btn-primary" id="saveChangesBtn">
              OK
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div
      class="modal fade"
      id="deleteModal"
      tabindex="-1"
      role="dialog"
      aria-labelledby="deleteModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog" role="document">
        <div class="modal-content modal-content-custom">
          <div class="modal-header modal-header-custom">
            <h5 class="modal-title" id="deleteModalLabel">
              Confirmar Eliminación
            </h5>
            <button
              type="button"
              class="close"
              data-dismiss="modal"
              aria-label="Close"
            >
              <span aria-hidden="true" style="color: white">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <p>
              ¿Está seguro de que desea eliminar este registro? Esta acción no
              se puede deshacer.
            </p>
          </div>
          <div class="modal-footer modal-footer-custom">
            <button
              type="button"
              class="btn btn-secondary"
              data-dismiss="modal"
            >
              No
            </button>
            <button type="button" class="btn btn-danger" id="confirmDeleteBtn">
              Sí, Eliminar
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Status Modal -->
    <div
      class="modal fade"
      id="statusModal"
      tabindex="-1"
      role="dialog"
      aria-labelledby="statusModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog" role="document">
        <div class="modal-content modal-content-custom">
          <div class="modal-header modal-header-custom">
            <h5 class="modal-title" id="statusModalLabel">
              Estado del paquete
            </h5>
            <button
              type="button"
              class="close"
              data-dismiss="modal"
              aria-label="Close"
            >
              <span aria-hidden="true" style="color: white">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <div class="status-modal-icon">
              <i class="fas fa-gift"></i>
            </div>
            <div class="status-modal-content">
              <p>
                Tu paquete se ha registrado correctamente. Si la información
                proporcionada es correcta, tu paquete se procesará como
                corresponde. Si hay alguna discrepancia, el paquete permanecerá
                en este estado hasta que se actualice o elimine la información.
              </p>
            </div>
          </div>
          <div class="modal-footer modal-footer-custom">
            <button type="button" class="btn btn-primary" data-dismiss="modal">
              Cerrar
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Scripts -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Bootstrap Datepicker -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/js/bootstrap-datepicker.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.9.0/locales/bootstrap-datepicker.es.min.js"></script>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // Extended sample data with 25 records including new columns
        const sampleData = [
          {
            fRegistro: "2025-09-01",
            tracking: "RCX785412369",
            asociado: "María Silva",
            agrupacion: "Grupo A",
            totalAgrupados: 125.5,
            cuponDescuento: "DESC10",
            estado: "Pendiente",
            pesoKilos: 2.5,
            pesoLibras: 5.51,
            uf: 0.003,
            descripcion: "Ropa y accesorios",
            observaciones: "Sin observaciones",
            grupo: "Grupo 1",
          },
          {
            fRegistro: "2025-09-02",
            tracking: "RCX963258741",
            asociado: "Carlos Rodríguez",
            agrupacion: "Grupo B",
            totalAgrupados: 345.75,
            cuponDescuento: "DESC15",
            estado: "En proceso",
            pesoKilos: 5.2,
            pesoLibras: 11.46,
            uf: 0.008,
            descripcion: "Electrónicos",
            observaciones: "Fragil",
            grupo: "Grupo 2",
          },
          {
            fRegistro: "2025-09-03",
            tracking: "RCX147852369",
            asociado: "Ana García",
            agrupacion: "Grupo C",
            totalAgrupados: 45.25,
            cuponDescuento: "DESC5",
            estado: "Completado",
            pesoKilos: 0.8,
            pesoLibras: 1.76,
            uf: 0.001,
            descripcion: "Documentos",
            observaciones: "Urgente",
            grupo: "Grupo 1",
          },
          {
            fRegistro: "2025-09-04",
            tracking: "RCX258741963",
            asociado: "Juan Pérez",
            agrupacion: "Grupo A",
            totalAgrupados: 289.9,
            cuponDescuento: "DESC20",
            estado: "Pendiente",
            pesoKilos: 4.7,
            pesoLibras: 10.36,
            uf: 0.007,
            descripcion: "Herramientas",
            observaciones: "Peso extra",
            grupo: "Grupo 3",
          },
          {
            fRegistro: "2025-09-05",
            tracking: "RCX369852147",
            asociado: "Laura Martínez",
            agrupacion: "Grupo B",
            totalAgrupados: 78.3,
            cuponDescuento: "DESC10",
            estado: "En proceso",
            pesoKilos: 1.5,
            pesoLibras: 3.31,
            uf: 0.002,
            descripcion: "Libros",
            observaciones: "Sin observaciones",
            grupo: "Grupo 2",
          },
          {
            fRegistro: "2025-09-06",
            tracking: "RCX741852963",
            asociado: "Miguel López",
            agrupacion: "Grupo C",
            totalAgrupados: 156.8,
            cuponDescuento: "DESC12",
            estado: "Pendiente",
            pesoKilos: 3.2,
            pesoLibras: 7.05,
            uf: 0.004,
            descripcion: "Juguetes",
            observaciones: "Regalo",
            grupo: "Grupo 1",
          },
          {
            fRegistro: "2025-09-07",
            tracking: "RCX852963741",
            asociado: "Sofía Hernández",
            agrupacion: "Grupo A",
            totalAgrupados: 92.45,
            cuponDescuento: "DESC8",
            estado: "Completado",
            pesoKilos: 2.1,
            pesoLibras: 4.63,
            uf: 0.002,
            descripcion: "Cosméticos",
            observaciones: "Líquidos limitados",
            grupo: "Grupo 3",
          },
          {
            fRegistro: "2025-09-08",
            tracking: "RCX963741852",
            asociado: "David González",
            agrupacion: "Grupo B",
            totalAgrupados: 234.6,
            cuponDescuento: "DESC18",
            estado: "En proceso",
            pesoKilos: 4.5,
            pesoLibras: 9.92,
            uf: 0.006,
            descripcion: "Deportes",
            observaciones: "Equipo deportivo",
            grupo: "Grupo 2",
          },
          {
            fRegistro: "2025-09-09",
            tracking: "RCX159753486",
            asociado: "Elena Castro",
            agrupacion: "Grupo C",
            totalAgrupados: 567.25,
            cuponDescuento: "DESC25",
            estado: "Pendiente",
            pesoKilos: 8.7,
            pesoLibras: 19.18,
            uf: 0.014,
            descripcion: "Muebles pequeños",
            observaciones: "Requiere ensamblaje",
            grupo: "Grupo 1",
          },
          {
            fRegistro: "2025-09-10",
            tracking: "RCX357159486",
            asociado: "Roberto Sánchez",
            agrupacion: "Grupo A",
            totalAgrupados: 412.8,
            cuponDescuento: "DESC15",
            estado: "Completado",
            pesoKilos: 6.3,
            pesoLibras: 13.89,
            uf: 0.01,
            descripcion: "Instrumentos musicales",
            observaciones: "Fragil",
            grupo: "Grupo 3",
          },
          {
            fRegistro: "2025-09-11",
            tracking: "RCX486357159",
            asociado: "Patricia Ruiz",
            agrupacion: "Grupo B",
            totalAgrupados: 189.75,
            cuponDescuento: "DESC10",
            estado: "En proceso",
            pesoKilos: 3.8,
            pesoLibras: 8.38,
            uf: 0.005,
            descripcion: "Arte",
            observaciones: "Manejar con cuidado",
            grupo: "Grupo 2",
          },
          {
            fRegistro: "2025-09-12",
            tracking: "RCX753159486",
            asociado: "Fernando Díaz",
            agrupacion: "Grupo C",
            totalAgrupados: 678.4,
            cuponDescuento: "DESC30",
            estado: "Pendiente",
            pesoKilos: 9.5,
            pesoLibras: 20.94,
            uf: 0.017,
            descripcion: "Equipo médico",
            observaciones: "Urgente",
            grupo: "Grupo 1",
          },
          {
            fRegistro: "2025-09-13",
            tracking: "RCX159486753",
            asociado: "Carmen Vargas",
            agrupacion: "Grupo A",
            totalAgrupados: 1234.5,
            cuponDescuento: "DESC50",
            estado: "Completado",
            pesoKilos: 12.8,
            pesoLibras: 28.22,
            uf: 0.03,
            descripcion: "Joyeria",
            observaciones: "Seguro requerido",
            grupo: "Grupo 3",
          },
          {
            fRegistro: "2025-09-14",
            tracking: "RCX486753159",
            asociado: "Javier Morales",
            agrupacion: "Grupo B",
            totalAgrupados: 345.25,
            cuponDescuento: "DESC15",
            estado: "En proceso",
            pesoKilos: 5.1,
            pesoLibras: 11.24,
            uf: 0.008,
            descripcion: "Repuestos automotrices",
            observaciones: "Piezas pesadas",
            grupo: "Grupo 2",
          },
          {
            fRegistro: "2025-09-15",
            tracking: "RCX753486159",
            asociado: "Isabel Torres",
            agrupacion: "Grupo C",
            totalAgrupados: 67.9,
            cuponDescuento: "DESC5",
            estado: "Pendiente",
            pesoKilos: 1.2,
            pesoLibras: 2.65,
            uf: 0.002,
            descripcion: "Material educativo",
            observaciones: "Sin observaciones",
            grupo: "Grupo 1",
          },
          {
            fRegistro: "2025-09-16",
            tracking: "RCX123456789",
            asociado: "Ricardo Mendez",
            agrupacion: "Grupo A",
            totalAgrupados: 198.75,
            cuponDescuento: "DESC12",
            estado: "Completado",
            pesoKilos: 3.5,
            pesoLibras: 7.72,
            uf: 0.005,
            descripcion: "Calzado deportivo",
            observaciones: "Tallas variadas",
            grupo: "Grupo 3",
          },
          {
            fRegistro: "2025-09-17",
            tracking: "RCX987654321",
            asociado: "Gabriela Rios",
            agrupacion: "Grupo B",
            totalAgrupados: 276.3,
            cuponDescuento: "DESC18",
            estado: "En proceso",
            pesoKilos: 4.8,
            pesoLibras: 10.58,
            uf: 0.007,
            descripcion: "Bolsos y carteras",
            observaciones: "Artículos de lujo",
            grupo: "Grupo 2",
          },
          {
            fRegistro: "2025-09-18",
            tracking: "RCX456123789",
            asociado: "Oscar Fuentes",
            agrupacion: "Grupo C",
            totalAgrupados: 432.85,
            cuponDescuento: "DESC20",
            estado: "Pendiente",
            pesoKilos: 6.7,
            pesoLibras: 14.77,
            uf: 0.011,
            descripcion: "Herramientas eléctricas",
            observaciones: "Baterías incluidas",
            grupo: "Grupo 1",
          },
          {
            fRegistro: "2025-09-19",
            tracking: "RCX789123456",
            asociado: "Lucia Mendoza",
            agrupacion: "Grupo A",
            totalAgrupados: 154.2,
            cuponDescuento: "DESC10",
            estado: "Completado",
            pesoKilos: 2.9,
            pesoLibras: 6.39,
            uf: 0.004,
            descripcion: "Suplementos nutricionales",
            observaciones: "Caducidad verificada",
            grupo: "Grupo 3",
          },
          {
            fRegistro: "2025-09-20",
            tracking: "RCX321654987",
            asociado: "Pedro Alvarado",
            agrupacion: "Grupo B",
            totalAgrupados: 298.65,
            cuponDescuento: "DESC15",
            estado: "En proceso",
            pesoKilos: 5.4,
            pesoLibras: 11.9,
            uf: 0.007,
            descripcion: "Equipo de camping",
            observaciones: "Artículos varios",
            grupo: "Grupo 2",
          },
          {
            fRegistro: "2025-09-21",
            tracking: "RCX654987321",
            asociado: "Valeria Cordova",
            agrupacion: "Grupo C",
            totalAgrupados: 87.4,
            cuponDescuento: "DESC8",
            estado: "Pendiente",
            pesoKilos: 1.8,
            pesoLibras: 3.97,
            uf: 0.002,
            descripcion: "Material de oficina",
            observaciones: "Sin observaciones",
            grupo: "Grupo 1",
          },
          {
            fRegistro: "2025-09-22",
            tracking: "RCX147258369",
            asociado: "Diego Herrera",
            agrupacion: "Grupo A",
            totalAgrupados: 543.9,
            cuponDescuento: "DESC25",
            estado: "Completado",
            pesoKilos: 7.9,
            pesoLibras: 17.42,
            uf: 0.013,
            descripcion: "Piezas de computadora",
            observaciones: "Componentes electrónicos",
            grupo: "Grupo 3",
          },
          {
            fRegistro: "2025-09-23",
            tracking: "RCX258369147",
            asociado: "Camila Ortiz",
            agrupacion: "Grupo B",
            totalAgrupados: 132.75,
            cuponDescuento: "DESC10",
            estado: "En proceso",
            pesoKilos: 2.7,
            pesoLibras: 5.95,
            uf: 0.003,
            descripcion: "Productos de belleza",
            observaciones: "Cosméticos",
            grupo: "Grupo 2",
          },
          {
            fRegistro: "2025-09-24",
            tracking: "RCX369147258",
            asociado: "Raul Jimenez",
            agrupacion: "Grupo C",
            totalAgrupados: 387.25,
            cuponDescuento: "DESC20",
            estado: "Pendiente",
            pesoKilos: 6.1,
            pesoLibras: 13.45,
            uf: 0.009,
            descripcion: "Repuestos industriales",
            observaciones: "Piezas metálicas",
            grupo: "Grupo 1",
          },
          {
            fRegistro: "2025-09-25",
            tracking: "RCX951753824",
            asociado: "Natalia Vega",
            agrupacion: "Grupo A",
            totalAgrupados: 76.8,
            cuponDescuento: "DESC8",
            estado: "Completado",
            pesoKilos: 1.6,
            pesoLibras: 3.53,
            uf: 0.002,
            descripcion: "Material textil",
            observaciones: "Telas variadas",
            grupo: "Grupo 3",
          },
        ];

        // State management
        let currentData = [...sampleData];
        let currentPage = 1;
        let entriesPerPage = 20;
        let filteredData = [...sampleData];
        let sortColumn = "fRegistro";
        let sortDirection = "asc";
        let currentEditingItem = null;
        let currentDeletingItem = null;

        // Initialize datepickers
        $(".datepicker").datepicker({
          format: "yyyy-mm-dd",
          language: "es",
          autoclose: true,
        });

        // Set initial dates
        $("#desde").datepicker("update", "2025-09-01");
        $("#hasta").datepicker("update", "2025-09-26");

        // Nav dropdown functionality
        const cards = {
          alertBtn: "alertCard",
          bellBtn: "bellCard",
          mailBtn: "mailCard",
          userBtn: "userCard",
        };

        function showAlert(message) {
          const alertContainer = document.getElementById("alertContainer");
          const alertMessage = document.getElementById("alertMessage");

          alertMessage.textContent = message;
          alertContainer.style.display = "block";
          void alertContainer.offsetWidth;
          alertContainer.classList.add("show");

          setTimeout(() => {
            alertContainer.classList.remove("show");
            setTimeout(() => {
              alertContainer.style.display = "none";
            }, 500);
          }, 3000);
        }

        function toggleCard(cardId) {
          document.querySelectorAll(".dropdown-card").forEach((card) => {
            if (card.id !== cardId) card.style.display = "none";
          });
          const card = document.getElementById(cardId);
          card.style.display =
            card.style.display === "block" ? "none" : "block";
        }

        Object.keys(cards).forEach((btnId) => {
          document.getElementById(btnId).addEventListener("click", (e) => {
            e.stopPropagation();
            toggleCard(cards[btnId]);
          });
        });

        document.addEventListener("click", function (e) {
          document.querySelectorAll(".dropdown-card").forEach((card) => {
            card.style.display = "none";
          });
        });

        document.querySelectorAll(".dropdown-card").forEach((card) => {
          card.addEventListener("click", (e) => e.stopPropagation());
        });

        // Format currency
        function formatCurrency(amount) {
          return "$" + amount.toFixed(2);
        }

        // Format weight
        function formatWeight(amount) {
          return amount.toFixed(2);
        }

        // Format UF
        function formatUF(amount) {
          return amount.toFixed(3);
        }

        // Sorting functionality
        function sortData(column, direction) {
          filteredData.sort((a, b) => {
            let aValue = a[column];
            let bValue = b[column];

            if (column === "fRegistro") {
              aValue = new Date(aValue);
              bValue = new Date(bValue);
            } else if (
              column === "totalAgrupados" ||
              column === "pesoKilos" ||
              column === "pesoLibras" ||
              column === "uf"
            ) {
              // Numeric sorting for currency and weight columns
              aValue = parseFloat(aValue);
              bValue = parseFloat(bValue);
            } else {
              aValue = String(aValue).toLowerCase();
              bValue = String(bValue).toLowerCase();
            }

            if (direction === "asc") {
              return aValue > bValue ? 1 : -1;
            } else {
              return aValue < bValue ? 1 : -1;
            }
          });
        }

        function updateSortArrows(column, direction) {
          // Reset all arrows
          document.querySelectorAll(".sort-arrow").forEach((arrow) => {
            arrow.classList.remove("active");
          });

          // Activate current sort arrows
          const currentTh = document.querySelector(`th[data-sort="${column}"]`);
          if (currentTh) {
            const upArrow = currentTh.querySelector(".sort-arrow.up");
            const downArrow = currentTh.querySelector(".sort-arrow.down");

            if (direction === "asc") {
              upArrow.classList.add("active");
            } else {
              downArrow.classList.add("active");
            }
          }
        }

        function setupSorting() {
          document.querySelectorAll("th[data-sort]").forEach((th) => {
            th.addEventListener("click", function () {
              const column = this.getAttribute("data-sort");

              if (sortColumn === column) {
                // Toggle direction if same column
                sortDirection = sortDirection === "asc" ? "desc" : "asc";
              } else {
                // New column, default to ascending
                sortColumn = column;
                sortDirection = "asc";
              }

              sortData(sortColumn, sortDirection);
              updateSortArrows(sortColumn, sortDirection);
              currentPage = 1;
              renderTable();
            });
          });
        }

        // Table functionality
        function renderTable() {
          const tableBody = document.getElementById("tableBody");
          const startIndex = (currentPage - 1) * entriesPerPage;
          const endIndex = Math.min(
            startIndex + entriesPerPage,
            filteredData.length
          );
          const pageData =
            entriesPerPage === "all"
              ? filteredData
              : filteredData.slice(startIndex, endIndex);

          tableBody.innerHTML = "";

          if (pageData.length === 0) {
            tableBody.innerHTML =
              '<tr><td colspan="14" class="text-center">No data available in table</td></tr>';
          } else {
            pageData.forEach((item) => {
              const row = document.createElement("tr");
              row.innerHTML = `
      <td>${item.fRegistro}</td>
      <td>${item.tracking}</td>
      <td>${item.asociado}</td>
      <td>${item.agrupacion}</td>
      <td class="currency">${formatCurrency(item.totalAgrupados)}</td>
      <td>${item.cuponDescuento}</td>
      <td>
        <div class="estado-content">
          <div class="estado-text">
            <i class="fas fa-gift gift-icon"></i>
            ${item.estado}
          </div>
          <button class="info-btn view-status-btn" data-tracking="${
            item.tracking
          }">Ver mas Info</button>
        </div>
      </td>
      <td class="currency">${formatWeight(item.pesoKilos)} kg</td>
      <td class="currency">${formatWeight(item.pesoLibras)} lb</td>
      <td class="currency">${formatUF(item.uf)}</td>
      <td>${item.descripcion}</td>
      <td>${item.observaciones}</td>
      <td>${item.grupo}</td>
      <td>
        <div class="action-buttons">
          <div class="action-row">
            <button class="action-btn edit-btn" data-tracking="${
              item.tracking
            }" title="Editar">
              <i class="fas fa-edit"></i>  
            </button>
            <button class="action-btn delete-btn" data-tracking="${
              item.tracking
            }" title="Eliminar">
              <i class="fas fa-trash"></i>  
            </button>
          </div>
          <div class="action-row">
            <button class="action-btn doc-btn" data-doc="1" title="Documento 1">
              <i class="fas fa-file"></i>  
            </button>
            <button class="action-btn doc-btn" data-doc="2" title="Documento 2">
              <i class="fas fa-file-alt"></i>      
            </button>
            <button class="action-btn doc-btn" data-doc="3" title="Documento PDF">
              <i class="fas fa-file-pdf"></i>    
            </button>
          </div>
        </div>
      </td>
    `;
              tableBody.appendChild(row);
            });
          }
          // Add event listeners for edit buttons
          document.querySelectorAll(".edit-btn").forEach((btn) => {
            btn.addEventListener("click", function (e) {
              e.preventDefault();
              const tracking = this.getAttribute("data-tracking");
              openEditModal(tracking);
            });
          });

          // Add event listeners for delete buttons
          document.querySelectorAll(".delete-btn").forEach((btn) => {
            btn.addEventListener("click", function (e) {
              e.preventDefault();
              const tracking = this.getAttribute("data-tracking");
              openDeleteModal(tracking);
            });
          });

          // Add event listeners for document buttons
          document.querySelectorAll(".doc-btn").forEach((btn) => {
            btn.addEventListener("click", function (e) {
              e.preventDefault();
              const docNumber = this.getAttribute("data-doc");
              openDocument(docNumber);
            });
          });

          // Add event listeners for status buttons
          document.querySelectorAll(".view-status-btn").forEach((btn) => {
            btn.addEventListener("click", function (e) {
              e.preventDefault();
              openStatusModal();
            });
          });

          updatePaginationInfo();
          renderPagination();
        }

        function openEditModal(tracking) {
          // Find the item by tracking number
          const item = sampleData.find((i) => i.tracking === tracking);
          if (!item) return;

          currentEditingItem = item;

          // Populate the modal with item data
          document.getElementById("ordenEnvio").value = item.descripcion;
          document.getElementById("noTracking").value = item.tracking;
          document.getElementById("valorCompra").value = formatCurrency(
            item.totalAgrupados
          );

          // Show the modal
          $("#editModal").modal("show");
        }

        function openDeleteModal(tracking) {
          // Find the item by tracking number
          const item = sampleData.find((i) => i.tracking === tracking);
          if (!item) return;

          currentDeletingItem = item;

          // Show the modal
          $("#deleteModal").modal("show");
        }

        function openStatusModal() {
          // Show the status modal
          $("#statusModal").modal("show");
        }

        function openDocument(docNumber) {
          const pdfUrls = {
            1: "https://courier.riocargoexpress.com/files/client/user_file_43740_1732642265.7783.pdf",
            2: "https://courier.riocargoexpress.com/files/client/user_file_43740_1732642176.0149.pdf",
            3: "https://courier.riocargoexpress.com/files/client/user_file_43740_1732642174.874.pdf",
          };

          if (pdfUrls[docNumber]) {
            // Open the PDF in a new tab
            window.open(pdfUrls[docNumber], "_blank");
            showAlert(`Abriendo documento ${docNumber} en nueva pestaña`);
          } else {
            showAlert(`Documento ${docNumber} no encontrado`);
          }
        }

        function updatePaginationInfo() {
          const totalEntries = filteredData.length;
          const startIndex = (currentPage - 1) * entriesPerPage + 1;
          const endIndex = Math.min(currentPage * entriesPerPage, totalEntries);
          const infoText =
            entriesPerPage === "all"
              ? `Showing all ${totalEntries} entries`
              : `Showing ${
                  totalEntries === 0 ? 0 : startIndex
                } to ${endIndex} of ${totalEntries} entries`;

          document.getElementById("paginationInfo").textContent = infoText;
        }

        function renderPagination() {
          if (
            entriesPerPage === "all" ||
            filteredData.length <= entriesPerPage
          ) {
            document.getElementById("pagination").innerHTML = "";
            return;
          }

          const totalPages = Math.ceil(filteredData.length / entriesPerPage);
          const pagination = document.getElementById("pagination");
          pagination.innerHTML = "";

          // Previous button
          const prevLi = document.createElement("li");
          prevLi.className = `page-item ${currentPage === 1 ? "disabled" : ""}`;
          prevLi.innerHTML = `<a class="page-link" href="#">Previous</a>`;
          prevLi.addEventListener("click", (e) => {
            e.preventDefault();
            if (currentPage > 1) {
              currentPage--;
              renderTable();
            }
          });
          pagination.appendChild(prevLi);

          // Page numbers - show limited pages with ellipsis
          const maxVisiblePages = 5;
          let startPage = Math.max(
            1,
            currentPage - Math.floor(maxVisiblePages / 2)
          );
          let endPage = Math.min(totalPages, startPage + maxVisiblePages - 1);

          if (endPage - startPage + 1 < maxVisiblePages) {
            startPage = Math.max(1, endPage - maxVisiblePages + 1);
          }

          // First page and ellipsis
          if (startPage > 1) {
            const firstLi = document.createElement("li");
            firstLi.className = "page-item";
            firstLi.innerHTML = `<a class="page-link" href="#">1</a>`;
            firstLi.addEventListener("click", (e) => {
              e.preventDefault();
              currentPage = 1;
              renderTable();
            });
            pagination.appendChild(firstLi);

            if (startPage > 2) {
              const ellipsisLi = document.createElement("li");
              ellipsisLi.className = "page-item disabled";
              ellipsisLi.innerHTML = `<span class="page-link">...</span>`;
              pagination.appendChild(ellipsisLi);
            }
          }

          // Page numbers
          for (let i = startPage; i <= endPage; i++) {
            const pageLi = document.createElement("li");
            pageLi.className = `page-item ${i === currentPage ? "active" : ""}`;
            pageLi.innerHTML = `<a class="page-link" href="#">${i}</a>`;
            pageLi.addEventListener("click", (e) => {
              e.preventDefault();
              currentPage = i;
              renderTable();
            });
            pagination.appendChild(pageLi);
          }

          // Last page and ellipsis
          if (endPage < totalPages) {
            if (endPage < totalPages - 1) {
              const ellipsisLi = document.createElement("li");
              ellipsisLi.className = "page-item disabled";
              ellipsisLi.innerHTML = `<span class="page-link">...</span>`;
              pagination.appendChild(ellipsisLi);
            }

            const lastLi = document.createElement("li");
            lastLi.className = "page-item";
            lastLi.innerHTML = `<a class="page-link" href="#">${totalPages}</a>`;
            lastLi.addEventListener("click", (e) => {
              e.preventDefault();
              currentPage = totalPages;
              renderTable();
            });
            pagination.appendChild(lastLi);
          }

          // Next button
          const nextLi = document.createElement("li");
          nextLi.className = `page-item ${
            currentPage === totalPages ? "disabled" : ""
          }`;
          nextLi.innerHTML = `<a class="page-link" href="#">Next</a>`;
          nextLi.addEventListener("click", (e) => {
            e.preventDefault();
            if (currentPage < totalPages) {
              currentPage++;
              renderTable();
            }
          });
          pagination.appendChild(nextLi);
        }
        function filterData() {
          const desde = $("#desde").val();
          const hasta = $("#hasta").val();
          const tracking = $("#tracking").val().toLowerCase();
          const descripcion = $("#descripcion").val().toLowerCase();

          filteredData = sampleData.filter((item) => {
            const itemDate = new Date(item.fRegistro);
            const desdeDate = new Date(desde);
            const hastaDate = new Date(hasta);

            const dateInRange = itemDate >= desdeDate && itemDate <= hastaDate;
            const trackingMatch = item.tracking
              .toLowerCase()
              .includes(tracking);
            const descripcionMatch = item.descripcion
              .toLowerCase()
              .includes(descripcion);

            return dateInRange && trackingMatch && descripcionMatch;
          });

          // Apply current sorting
          sortData(sortColumn, sortDirection);
          currentPage = 1;
          renderTable();
          showAlert(
            `Filtro aplicado: ${filteredData.length} registros encontrados`
          );
        }

        function clearFilters() {
          $("#desde").datepicker("update", "2025-09-01");
          $("#hasta").datepicker("update", "2025-09-26");
          $("#tracking").val("");
          $("#descripcion").val("");
          filterData();
          showAlert("Filtros limpiados");
        }

        // Event listeners
        document
          .getElementById("filtrarBtn")
          .addEventListener("click", filterData);
        document
          .getElementById("limpiarBtn")
          .addEventListener("click", clearFilters);
        // File upload functionality
        const fileUploadContainer = document.getElementById(
          "fileUploadContainer"
        );
        const fileInput = document.getElementById("fileInput");

        fileUploadContainer.addEventListener("click", () => {
          fileInput.click();
        });

        fileUploadContainer.addEventListener("dragover", (e) => {
          e.preventDefault();
          fileUploadContainer.classList.add("dragover");
        });

        fileUploadContainer.addEventListener("dragleave", () => {
          fileUploadContainer.classList.remove("dragover");
        });

        fileUploadContainer.addEventListener("drop", (e) => {
          e.preventDefault();
          fileUploadContainer.classList.remove("dragover");
          if (e.dataTransfer.files.length) {
            fileInput.files = e.dataTransfer.files;
            showAlert("Archivo cargado exitosamente");
          }
        });

        fileInput.addEventListener("change", () => {
          if (fileInput.files.length) {
            showAlert("Archivo cargado exitosamente");
          }
        });

        // Save changes button functionality
        document
          .getElementById("saveChangesBtn")
          .addEventListener("click", () => {
            // In a real application, you would save the changes to your data source
            showAlert("Cambios guardados exitosamente");
            $("#editModal").modal("hide");
          });

        // Confirm delete button functionality
        document
          .getElementById("confirmDeleteBtn")
          .addEventListener("click", () => {
            // In a real application, you would delete the item from your data source
            if (currentDeletingItem) {
              showAlert(
                `Registro ${currentDeletingItem.tracking} eliminado exitosamente`
              );
              $("#deleteModal").modal("hide");
              currentDeletingItem = null;
            }
          });

        // Hello button functionality
        document.getElementById("helloBtn").addEventListener("click", () => {
          showAlert("   Agregar nueva Agrupación!");
        });

        // Hello2 button functionality
        document.getElementById("hello2Btn").addEventListener("click", () => {
          showAlert("button clicked!");
        });

        // Event listeners
        document
          .getElementById("filtrarBtn")
          .addEventListener("click", filterData);
        document
          .getElementById("limpiarBtn")
          .addEventListener("click", clearFilters);

        document
          .getElementById("entriesSelect")
          .addEventListener("change", function () {
            entriesPerPage =
              this.value === "all" ? "all" : parseInt(this.value);
            currentPage = 1;
            renderTable();
          });

        // Initialize
        sortData(sortColumn, sortDirection);
        updateSortArrows(sortColumn, sortDirection);
        setupSorting();
        renderTable();
        filterData();

        // Make functions available globally
        window.showAlert = showAlert;
        window.openEditModal = openEditModal;
        window.openDeleteModal = openDeleteModal;
        window.openStatusModal = openStatusModal;
        window.openDocument = openDocument;
      });
    </script>
  </body>
</html>
